<div class="flex items-center justify-between mb-6">
  <h1 class="text-3xl font-bold text-forest-800">Carte des boissons</h1>
  <%= link_to "Ajouter une boisson", new_admin_beverage_path, class: "bg-gold-500 text-white px-4 py-2 rounded hover:bg-gold-600 transition-colors" %>
</div>

<% Beverage::CATEGORIES.each do |category_key, category_label| %>
  <% beverages = @beverages_by_category[category_key] %>

  <div class="mb-8">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-forest-700"><%= category_label %></h2>
      <%= link_to "Ajouter", new_admin_beverage_path(category: category_key), class: "text-sm bg-forest-600 text-white px-3 py-1 rounded hover:bg-forest-700 transition-colors" %>
    </div>

    <div class="bg-white rounded-lg shadow overflow-hidden">
      <table class="w-full">
        <thead class="bg-forest-800 text-white">
          <tr>
            <th class="px-4 py-3 text-left w-12">#</th>
            <th class="px-4 py-3 text-left">Nom</th>
            <th class="px-4 py-3 text-left">Description</th>
            <th class="px-4 py-3 text-center">Prix</th>
            <th class="px-4 py-3 text-center">Actif</th>
            <th class="px-4 py-3 text-right">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <% if beverages&.any? %>
            <% beverages.each do |beverage| %>
              <tr class="hover:bg-gray-50 <%= 'opacity-50' unless beverage.active %>">
                <td class="px-4 py-3 text-gray-500 text-sm"><%= beverage.position %></td>
                <td class="px-4 py-3 font-medium"><%= beverage.name %></td>
                <td class="px-4 py-3 text-sm text-gray-600"><%= truncate(beverage.description, length: 40) %></td>
                <td class="px-4 py-3 text-center text-sm">
                  <% if beverage.has_multiple_sizes? %>
                    <span class="text-xs">
                      <%= beverage.price_small.present? ? "#{number_to_currency(beverage.price_small, unit: '€', format: '%n%u')}" : "" %>
                      <%= beverage.price_medium.present? ? "/ #{number_to_currency(beverage.price_medium, unit: '€', format: '%n%u')}" : "" %>
                      <%= beverage.price_large.present? ? "/ #{number_to_currency(beverage.price_large, unit: '€', format: '%n%u')}" : "" %>
                    </span>
                  <% else %>
                    <%= number_to_currency(beverage.price, unit: "€", format: "%n %u") %>
                  <% end %>
                </td>
                <td class="px-4 py-3 text-center">
                  <% if beverage.active %>
                    <span class="inline-block w-3 h-3 bg-green-500 rounded-full" title="Actif"></span>
                  <% else %>
                    <span class="inline-block w-3 h-3 bg-gray-300 rounded-full" title="Inactif"></span>
                  <% end %>
                </td>
                <td class="px-4 py-3 text-right">
                  <%= link_to "Modifier", edit_admin_beverage_path(beverage), class: "text-forest-600 hover:text-forest-800 mr-3" %>
                  <%= link_to "Supprimer", admin_beverage_path(beverage), method: :delete, data: { turbo_method: :delete, turbo_confirm: "Êtes-vous sûr ?" }, class: "text-red-600 hover:text-red-800" %>
                </td>
              </tr>
            <% end %>
          <% else %>
            <tr>
              <td colspan="6" class="px-4 py-6 text-center text-gray-500">Aucune boisson dans cette catégorie.</td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>
